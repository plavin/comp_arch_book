
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Phase Detection Lag &#8212; Phase Analysis in SST</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Model Size" href="modelsize.html" />
    <link rel="prev" title="Cache Listeners" href="../sst/listeners.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Phase Analysis in SST</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Phase Analysis in SST
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Phase Analysis
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../phase/intro.html">
   Intro to Phase Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../phase/dhodapkar.html">
   Working-Set Based Phase Analysis
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  SST
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../sst/overview.html">
   SST Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sst/memhierarchy.html">
   SSTâ€™s MemHierarchy Library
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sst/memevent.html">
   MemEvent objects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../sst/listeners.html">
   Cache Listeners
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Errata
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Phase Detection Lag
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="modelsize.html">
   Model Size
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Papers
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../papers/simulation.html">
   Simulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../papers/benchmarking.html">
   Benchmarking
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../papers/phaseanalysis.html">
   Phase Analysis
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/errata/pdlag.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/plavin/comp_arch_book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/plavin/comp_arch_book/issues/new?title=Issue%20on%20page%20%2Ferrata/pdlag.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#potential-solutions">
   Potential Solutions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#checkpoint-restart">
     Checkpoint-Restart
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#phase-prediction">
     Phase prediction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-ahead-phase-detection">
     Run-ahead Phase Detection
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="phase-detection-lag">
<h1>Phase Detection Lag<a class="headerlink" href="#phase-detection-lag" title="Permalink to this headline">Â¶</a></h1>
<p><em>Phase detection lag</em> occurs when a a component is notified of a phase change one interval after the phase has actually ended. This occurs because the phase detector is unable to report on the current phase until the interval is ended so it can generate a signature and classify it. This is an issue for model swapping: although we can hold off on training models until the end of a phase when we know what phase we were in, we cannot do the same when a model is already swapped. This means that when we are running with a swapped model, the interval after the end of a phase will be run with a model trained for the phase that just ended, instead of the proper model.</p>
<div class="figure align-default" id="pdlag-fig">
<a class="reference internal image-reference" href="../_images/pdlag.png"><img alt="../_images/pdlag.png" src="../_images/pdlag.png" style="height: 225px;" /></a>
<p class="caption"><span class="caption-number">Fig. 1 </span><span class="caption-text">A visual depiction of phase detection lag.</span><a class="headerlink" href="#pdlag-fig" title="Permalink to this image">Â¶</a></p>
</div>
<div class="section" id="potential-solutions">
<h2>Potential Solutions<a class="headerlink" href="#potential-solutions" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="checkpoint-restart">
<h3>Checkpoint-Restart<a class="headerlink" href="#checkpoint-restart" title="Permalink to this headline">Â¶</a></h3>
<p>We can checkpoint the simulation at the end of every interval, and rollback if we find out that we ran with the wrong model. In a simulation environment with an intelligent checkpoint restart mechanism, we may be able
to only redo computation that depended on components that were rolled back. However, I donâ€™t believe SST supports this, and and I think that even with this in place, the overhead would be large for simulations with short phases. We would have to rollback everytime a phase ended, essentially.</p>
</div>
<div class="section" id="phase-prediction">
<h3>Phase prediction<a class="headerlink" href="#phase-prediction" title="Permalink to this headline">Â¶</a></h3>
<p>Phase prediction involves predicting what the next interval will be classified as before it is run. This can be thought of as two separate problems: (1) how long will the current phase run for, and (2) what will be the next phase that runs. There are two ways this could help alleveiate the problem:</p>
<ul class="simple">
<li><p>We could implement phase prediction on its own. With a high enough percentage of correct predictions, we would not be running the wrong model as frequently, which would improve the accuracy of our simulation.</p></li>
<li><p>We could impelement phase prediction in addition to checkpoint restart. Correct predictions would mean that we would alleviate the need for a rollback on correctly predicted phase endings. It does not alleviate the need to checkpoint at every interval though, as we may mispredict a phase ending and still need to rollback.</p></li>
</ul>
</div>
<div class="section" id="run-ahead-phase-detection">
<h3>Run-ahead Phase Detection<a class="headerlink" href="#run-ahead-phase-detection" title="Permalink to this headline">Â¶</a></h3>
<p>We could move the phase prediction earlier in the simulation, and have it run one interval ahead of the rest of the simulation. This would mean that the phase detector could send perfect phase information to listeners.</p>
<p>This is not a silver bullet though. Drawbacks include:</p>
<ul class="simple">
<li><p>If the phase detector is run before the simulation of an interval, it will only have access to data from the program trace it is reading. Some approaches to phase detection using things like branch mispredictions as part of their classification criteria, which would not be available to us.</p></li>
<li><p>Speaking of program traces, this approach will hurt the generality of our implementation, as it will assume that it has access to a program trace, which is not true if the core is simulating the code itself, as opposed to replaying a trace it is given.</p></li>
<li><p>Finally, we canâ€™t forget that online phase detection has application in hardware. If we want our approach to work in this area, it canâ€™t have magic knowledge of the future.</p></li>
</ul>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./errata"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="../sst/listeners.html" title="previous page">Cache Listeners</a>
    <a class='right-next' id="next-link" href="modelsize.html" title="next page">Model Size</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Patrick Lavin<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>